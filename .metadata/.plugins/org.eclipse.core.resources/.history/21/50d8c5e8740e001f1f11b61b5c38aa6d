<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.fitnect.model.dao.GymDao">

    <resultMap id="gymResultMap" type="com.ssafy.fitnect.model.dto.Gym">
        <id property="gymId" column="gymId"/>
        <result property="name" column="name"/>
        <result property="address" column="address"/>
        <result property="longitude" column="longitude"/>
        <result property="latitude" column="latitude"/>
        <result property="phone" column="phone"/>
        <result property="content" column="content"/>
        <result property="type" column="type"/>
        <result property="operationHours" column="operationHours"/>
        <result property="closedDay" column="closedDay"/>
        <result property="gymImgUrl" column="gymImgUrl"/>
        <result property="capacity" column="capacity"/>
        <result property="rating" column="rating"/>
        <result property="createdDate" column="createdDate"/>
        <result property="modifiedDate" column="modifiedDate"/>

        <!-- Association mappings -->
        <association property="amenity" javaType="com.ssafy.fitnect.model.dto.Amenity">
            <id property="amenityId" column="amenityId"/>
            <result property="freeParking" column="freeParking"/>
            <result property="paidParking" column="paidParking"/>
            <result property="allDay" column="allDay"/>
            <result property="showerFacilities" column="showerFacilities"/>
            <result property="sportsWear" column="sportsWear"/>
            <result property="sharedLocker" column="sharedLocker"/>
            <result property="personalLocker" column="personalLocker"/>
            <result property="unmanded" column="unmanded"/>
        </association>
        
        <!-- Collection mappings -->
        <collection property="clazz" ofType="com.ssafy.fitnect.model.dto.Class">
            <id property="classId" column="classId"/>
            <result property="trainorId" column="trainorId"/>
            <result property="name" column="name"/>
            <result property="startDate" column="startDate"/>
            <result property="endDate" column="endDate"/>
            <result property="createDate" column="createDate"/>
            <result property="minimum" column="minimum"/>
            <result property="current" column="current"/>
            <result property="maximum" column="maximum"/>
            <result property="price" column="price"/>
        </collection>
        
        <collection property="gymMachine" ofType="com.ssafy.fitnect.model.dto.GymMachine">
            <id property="infoId" column="infoId"/>
            <result property="machineCount" column="machineCount"/>
            <result property="machineName" column="machineName"/>
        </collection>
    </resultMap>
    
    <select id="selectAllGym" resultMap="gymResultMap">
        SELECT
            g.gymId,
            g.name,
            g.address,
            g.longitude,
            g.latitude,
            g.phone,
            g.content,
            g.type,
            g.operationours,
            g.closedDay,
            g.gymImgUrl,
            g.capacity,
            g.rating,
            g.createdDate,
            g.modifiedDate,
            a.amenityId,
            a.freeParking,
            a.paidParking,
            a.allDay,
            a.showerFacilities,
            a.sportsWear,
            a.sharedLocker,
            a.personalLocker,
            a.unmanded,
            c.classId,
            c.trainorId,
            c.className,
            c.startDate,
            c.endDate,
            c.createDate,
            c.minimum,
            c.current,
            c.maximum,
            c.price,
            m.infoId,
            m.machineCount,
            m.machineName
        FROM gym g
        LEFT JOIN amenity a ON g.gymId = a.gymId
        LEFT JOIN class c ON g.gymId = c.gymId
        LEFT JOIN gym_Machine m ON g.gymId = m.gymId
        WHERE g.gymId = #{gymId}
    </select>


</mapper>